external-dns:
  fullnameOverride: external-dns-adguard
  serviceMonitor:
    enabled: true
  logLevel: debug
  logFormat: json
  sources:
  - service
  - gateway-httproute
  provider:
    name: webhook
    webhook:
      image:
        repository: ghcr.io/muhlba91/external-dns-provider-adguard
        tag: latest
        pullPolicy: IfNotPresent
      service:
        port: 8080
      env:
      - name: LOG_LEVEL
        value: debug
      - name: ADGUARD_URL
        value: "https://adguard.nullservers.com/control/"
      - name: ADGUARD_USER
        valueFrom:
          secretKeyRef:
            name: adguard-credentials
            key: username
      - name: ADGUARD_PASSWORD
        valueFrom:
          secretKeyRef:
            name: adguard-credentials
            key: password
      - name: DRY_RUN
        value: "false"

  txtPrefix: ed-
  extraArgs:
  - --webhook-provider-url=http://localhost:8888

  sidecars:
  - name: adguard-webhook
    image: -adguard:latest
    imagePullPolicy: IfNotPresent
    ports:
    - containerPort: 8888
      name: http
    - containerPort: 8080
      name: healthz
